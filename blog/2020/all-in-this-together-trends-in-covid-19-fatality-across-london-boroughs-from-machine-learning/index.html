<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p><em>Keywords: COVID-19, London, city, data science, pandas, geopandas, scikit-learn, geospatial, maps, race, matplotlib, modeling, boroughs, numpy, selenium, python, machine learning, data visualization</em></p> <blockquote>Author’s note: this was a short project done several years ago and contains some non-rigorous modelling and visualisation missing key components. So while it remains an interesting data exploration project, I would discourage anyone from drawing definite conclusions using these methods.</blockquote> <p>From the end of 2019, the SARS-CoV-2 pandemic has flooded our newsfeeds and headlines with a vast array of numbers; we measure the local growth using the R number, compare the effectiveness of lockdown measures in different countries using cases per population number, and we see the deaths that the official COVID fatalities miss through the excess deaths. Another measure of the seriousness of the disease, and one which can highlight where adequate medical care is not being brought, is the ratio of the deaths due to COVID and the cases diagnosed in an area. This is the quantity I will be exploring in this project.</p> <p>We know that there are many health factors that affect the COVID-19 mortality rate, including weight, age, smoking and underlying conditions like diabetes and asthma. One of the more shocking statistics to emerge, however, has been the strong positive correlation between COVID prevalence and non-white persons. <a href="https://www.cdc.gov/coronavirus/2019-ncov/covid-data/investigations-discovery/hospitalization-death-by-race-ethnicity.html" rel="external nofollow noopener" target="_blank">An analysis from the CDC published in August</a> showed that, compared to white individuals, hispanic or Latino persons are 2.8 times as likely to catch the virus, American Indian or Alaska native persons are 5.3 times as likely to be hospitalised, and Black or African American persons have a fatality rate 2.1 times as high. These statistics are stark indicators, that despite what recent advertisements like to say, for many people, we’re most certainly not in this together.</p> <p>To examine this discrepancy in COVID-19 prevalence across different groups and attempt to somewhat visualise it, I decided to look at the cases and deaths of the disease across the boroughs of London. I knew the Office for National Statistics (ONS) would have more detailed versions of the information I was looking for to investigate the trends, and as a large, international city with many different groups in it, London would provide me with the range of data I was looking for to gain some understanding of what affects a person’s chances of surviving catching the coronavirus.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*MKncdJRLtbZ9sNGj"><figcaption>Credit: Zoltan Gabor Photography</figcaption></figure> <h3>The Data</h3> <p>I pulled together a range of data sources to use in this project, which I will briefly describe below.</p> <p>To visualise the London boroughs, I used a GeoJSON file from the website of Stuart Grange, a postdoctoral researcher at Empa, Switzerland. This file can be found <a href="https://skgrange.github.io/www/data/london_boroughs.json" rel="external nofollow noopener" target="_blank">here</a>.</p> <p>The ONS regularly publishes information on the deaths attributed to the coronavirus online, which can be found <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/birthsdeathsandmarriages/deaths/datasets/deathsinvolvingcovid19bylocalareaanddeprivation" rel="external nofollow noopener" target="_blank">here</a>. It also breaks down information on the positive case tests in to regions, which can be found <a href="https://coronavirus.data.gov.uk/cases" rel="external nofollow noopener" target="_blank">here</a>.</p> <p>The demographics of London have its own <a href="https://en.wikipedia.org/wiki/Demography_of_London" rel="external nofollow noopener" target="_blank">Wikipedia page</a>, and it was from this that I was able to scrape the racial makeup of each borough (originally from the 2011 UK census).</p> <p>While censuses in the UK take place every 10 years, <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationestimates/datasets/populationestimatesforukenglandandwalesscotlandandnorthernireland" rel="external nofollow noopener" target="_blank">the ONS continues to estimate the population changes in each of its administrative areas in between these</a>. This includes ages, sex, population densities and immigrations.</p> <h3>Cleaning the Data</h3> <p>Firstly, I imported the GeoJSON file, and simply plotting the dataframe shows the geographic data.</p> <iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/8863d4721e0c668431ee6b1aaba86fae/href" rel="external nofollow noopener" target="_blank">https://medium.com/media/8863d4721e0c668431ee6b1aaba86fae/href</a></iframe> <figure><img alt="" src="https://cdn-images-1.medium.com/max/614/1*6BYBarxvNsW7ducir_ZhPQ.png"><figcaption>London geoJSON data</figcaption></figure> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*ohx-3kilApkP7sWvoebpuQ.png"><figcaption>London from above with Google Maps</figcaption></figure> <p>The geoJSON data seems to match what we expect, so we’ll move forward with importing the COVID deaths for each borough.</p> <p>The ONS reports a lot of information that’s heavily annotated, so a bit of cleaning was involved. This included removing the first few rows of the datasheet, dropping columns we weren’t interested in and renaming others, shortening the names of regions, and removing the non-COVID death columns.</p> <iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/5570427b32c4421aca8538b967a8dfbc/href" rel="external nofollow noopener" target="_blank">https://medium.com/media/5570427b32c4421aca8538b967a8dfbc/href</a></iframe> <figure><img alt="" src="https://cdn-images-1.medium.com/max/589/1*rh3SJAt3rcMDoWFKe_ChDA.png"><figcaption>Deaths compiled by the ONS for London boroughs.</figcaption></figure> <p>A similar method for cleaning the COVID cases data is shown below. However, as the cases are given in week numbers, they must be converted to dates. For this a function was made, which was then implemented by making a dictionary in a list comprehension.</p> <iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/12cd31ded63dfeef76839365c6396afa/href" rel="external nofollow noopener" target="_blank">https://medium.com/media/12cd31ded63dfeef76839365c6396afa/href</a></iframe> <figure><img alt="" src="https://cdn-images-1.medium.com/max/911/1*tsjdDIpDo1aadB4WgMweAQ.png"><figcaption>New column of summed cases highlighted.</figcaption></figure> <p>The summed cases until the month of July have now been added to the dataframe, and appear as how we would expect.</p> <p>The race data can now be extracted from the Wikipedia page. This was done using the selenium and BeautifulSoup libraries.</p> <p>The table of race demographics is contained in a table of class ‘wikitable sortable’. In this table, the values are held in &lt;td&gt; tags, and the race headings and boroughs are held in &lt;th&gt; tags. Functions were defined to extract the values and boroughs from each of these tags. These were saved to arrays using list comprehensions, the data was reshaped and then formed into a dataframe.</p> <iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/ff70a1c377f36dd9870fb47c39737ed2/href" rel="external nofollow noopener" target="_blank">https://medium.com/media/ff70a1c377f36dd9870fb47c39737ed2/href</a></iframe> <p>The dataframe we’ve extracted matches what we would expect.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/480/1*gldOoQpgIhpBvJ1hUb21CA.png"><figcaption>Races across the London boroughs, extracted from a Wikipedia article.</figcaption></figure> <p>All these data sources are easily joined together using pandas concat function, with the borough name set as the index. The ratio of deaths to cases can be added to the dataframe easily using pandas. Taking a look at this across London shows a significant spread.</p> <iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/f973227b26ecac507d9244ce5d8d4a2e/href" rel="external nofollow noopener" target="_blank">https://medium.com/media/f973227b26ecac507d9244ce5d8d4a2e/href</a></iframe> <figure><img alt="" src="https://cdn-images-1.medium.com/max/670/1*ilnw69Mhdo2mhvNwLE1oRg.png"><figcaption>Deaths:cases ratio for each London borough</figcaption></figure> <p>The median ages for each borough are extracted from the population estimates done by the ONS. Using the areas provided in the geoJSON file, population densities for each borough can be found.</p> <iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/57f972e1c01590e99923ae9c07cbbfc4/href" rel="external nofollow noopener" target="_blank">https://medium.com/media/57f972e1c01590e99923ae9c07cbbfc4/href</a></iframe> <h3>Measuring the trends using linear regression</h3> <p>To model the data, scikit-learn’s ridge regression model was used, to reduce the chances of overfitting, which seems likely given the co-linearity of some of the variables I have chosen. A function to make a model and plot it against the known data was used.</p> <p>When a model is intended to make future predictions, and thus must have its accuracy measured, the data is split into training and testing sets. In this case, I am only interested in the trends of the data and thus shall simply be using the entire dataset (consisting of 33 boroughs, not exactly very large).</p> <iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/4cabee1c6a32df2419018f463ae48aae/href" rel="external nofollow noopener" target="_blank">https://medium.com/media/4cabee1c6a32df2419018f463ae48aae/href</a></iframe> <p>Modelling using all the features we have incorporated into our dataframe provides us with coefficients for each of our variables, as well as a visual comparison against the known death:case ratio.</p> <pre>Features : ['White', 'Black', 'Asian', 'Other', 'Median Age', 'Population Density']<br>Coefficients: [[-0.00021014  0.00180947  0.00084168  0.00486416  0.00339385 -0.00033938]]<br>RMSE: 0.024022110590386066<br>Coefficient of determination (r^2): 0.4202066115941455</pre> <p>There’s a few insights we can quickly gleam from these results. In terms of the model fit, a value of R^2=0.42 shows that, while the model is far from a perfect fit, it’s at least doing significantly better that a purely random model, and there is some correlation in the feature and target varibles. The coefficients are definitely interesting. While there is a negative correlation between the COVID death:cases ratio and the proportion of white people in a borough, the model suggests that the expected fatality of the virus increases with the proportion of every other race in that borough.</p> <p>In fact, if we take the magnitudes of the coefficients as indications of the dependence of these variables on the fatality of the disease, race seems to have roughly the same effect as the medium age. In fact, population density, with a coefficient an order of magnitude, places a surprisingly small role. The model is shown against the original data below, both as a map and as a scatter plot.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/823/1*4kQZmdF_eYygAOPYlRMq-Q.png"><figcaption>Death:cases ratio for the London broughs (original data on left, predictions of linear regression model on right).</figcaption></figure> <figure><img alt="" src="https://cdn-images-1.medium.com/max/713/1*gW32bFpYCbR5NBLdmiPP3g.png"><figcaption>Death:cases ratio for London boroughs to the end of July (original data in blue, predicted in red).</figcaption></figure> <h3>Conclusions and Moving Forward</h3> <p>In conclusion, this model seems to strongly suggest that in the boroughs of London, race played a significant role in the chances of COVID-fatality at the end of July. Having a socioeconomic statistic like this be on par with a physical health measure is a serious aspect of the diseases progression, which is due a full explanation.</p> <p>The range of COVID-related fatalities across London shows that the help available is not evenly and fairly distributed. The relation of race to COVID-fatality could be due to biological reasons, or as has been seen with previous natural disasters and health crises, its relationship with poorer economic status, more cramped households, and poorer access to facilities. A <a href="https://www.nature.com/articles/s41586-020-2521-4" rel="external nofollow noopener" target="_blank">Nature paper examining factors associated with COVID-19-related death</a> concluded that “South Asian and Black people had a substantially higher risk of COVID-19-related death than white people, and this was only partly attributable to comorbidities, deprivation or other factors”, strongly implying this socioeconomic factors are playing a significant role.</p> <p>Obviously this project is meant to be far from the end-all and be-all of examining the factors affecting COVID-19 fatality in London, and there are several prominent limitations. Firstly, it has been well documented that in the first half of 2020, the testing facilities of the UK were completely overwhelmed, so we know that number of cases documented was very far from the true value. In addition, the racial demographics were taken from the 2011 census and may have shifted in the past few years. Simply taking the median age of a population may not give a true representation of the ages of the population; a care home in a relatively youthful borough would not be represented by this statistic.</p> <p>In terms of producing a model that could make better predictions, further work is planned in to adding new features and performing some feature selection. Another interesting insight into the progression of the pandemic would involve using more recent data to see if this correlation with race has continued as measures to mitigate the virus and the use of new drugs like dexamethasone have begun to be used.</p> <p>That’s the end of my project. I hope you see how a small amount of web scraping, data manipulation and machine learning can give us a bit of an insight into the forces that are changing our modern world. Thank you for your time and any feedback is appreciated!</p> <p>Feel free to connect with me on <a href="https://www.linkedin.com/in/conor-hamill-53961419a/" rel="external nofollow noopener" target="_blank">LinkedIn</a>, and the code used in this project can be found at <a href="https://github.com/conorhamill36/London_COVID" rel="external nofollow noopener" target="_blank">https://github.com/conorhamill36/London_COVID</a>.</p> <p>This project was written on a jupyter notebook hosted on an AWS EC2 instance. This can be set up using the instructions found in <a href="https://chrisalbon.com/aws/basics/run_project_jupyter_on_amazon_ec2/" rel="external nofollow noopener" target="_blank">this guide by Chris Albon</a>. The use of geoJSON data with GeoPandas was inspired by <a href="https://towardsdatascience.com/predicting-airbnb-prices-with-machine-learning-and-location-data-5c1e033d0a5a" rel="external nofollow noopener" target="_blank">this article</a> from <a href="https://towardsdatascience.com/@gracecarrilloc?source=post_page-----5c1e033d0a5a--------------------------------" rel="external nofollow noopener" target="_blank">Graciela Carrillo</a>, modelling Airbnb prices in Edinburgh.</p> <p><img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=e481c99d5cf0" width="1" height="1" alt="">&lt;hr&gt;&lt;p&gt;<a href="https://medium.com/swlh/all-in-this-together-trends-in-covid-19-fatality-across-london-boroughs-from-machine-learning-e481c99d5cf0" rel="external nofollow noopener" target="_blank">All in This Together? Trends in COVID-19 Fatality Across London Boroughs From Machine Learning</a> was originally published in <a href="https://medium.com/swlh" rel="external nofollow noopener" target="_blank">The Startup</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.&lt;/p&gt;</p> </body></html>